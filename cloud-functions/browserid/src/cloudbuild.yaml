timeout: 10m
steps:
- id: go_version
  name: "gcr.io/cloud-builders/go"
  args: ["version"]
  env: ["GOPATH=."]

- id: go_build
  name: "gcr.io/cloud-builders/go"
  args: ["build", "browserid"]
  env: [
    "PROJECT_ROOT=cloud-functions/browserid"
  ]  
#- name: 'gcr.io/cloud-builders/gcloud'
#  args: ['functions', 'deploy','browser-id-dev','--entry-point','Main', '--runtime','go111','--trigger-http', "--project", "${PROJECT_ID}", "--env-vars-file", ".env.$BRANCH_NAME.yaml"]
tags: ['$BRANCH_NAME']    
artifacts:
  objects:
    location: 'gs://ci-$BRANCH_NAME'
    paths: ['browserid']